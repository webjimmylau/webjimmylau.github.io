(this["webpackJsonpbounty-admin-pc"]=this["webpackJsonpbounty-admin-pc"]||[]).push([[24],{473:function(e,t,n){e.exports={box:"setting_role_create_box__1ByJD",form:"setting_role_create_form__3aQeR",item:"setting_role_create_item__3w0Gq",roleList:"setting_role_create_roleList__1TYXC"}},476:function(e,t,n){"use strict";var c=n(2),a=n(1),r=n(0),o=n.n(r),l=n(351),i=n(5),s=n.n(i),u=n(7),d=n(6),f=n(152),b=n.n(f),j=n(345),O=n(328),m=n(364),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"},h=n(13),x=function(e,t){return r.createElement(h.a,Object.assign({},e,{ref:t,icon:p}))};x.displayName="FolderOpenOutlined";var v=r.forwardRef(x),y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 298.4H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder",theme:"outlined"},N=function(e,t){return r.createElement(h.a,Object.assign({},e,{ref:t,icon:y}))};N.displayName="FolderOutlined";var g,E=r.forwardRef(N),k=n(59);function w(e,t){e.forEach((function(e){var n=e.key,c=e.children;!1!==t(n,e)&&w(c||[],t)}))}function K(e){var t=e.treeData,n=e.expandedKeys,c=e.startKey,a=e.endKey,r=[],o=g.None;if(c&&c===a)return[c];if(!c||!a)return[];return w(t,(function(e){if(o===g.End)return!1;if(function(e){return e===c||e===a}(e)){if(r.push(e),o===g.None)o=g.Start;else if(o===g.Start)return o=g.End,!1}else o===g.Start&&r.push(e);return-1!==n.indexOf(e)})),r}function I(e,t){var n=Object(u.a)(t),c=[];return w(e,(function(e,t){var a=n.indexOf(e);return-1!==a&&(c.push(t),n.splice(a,1)),!!n.length})),c}!function(e){e[e.None=0]="None",e[e.Start=1]="Start",e[e.End=2]="End"}(g||(g={}));var _=function(e,t){var n={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(n[c]=e[c]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(c=Object.getOwnPropertySymbols(e);a<c.length;a++)t.indexOf(c[a])<0&&Object.prototype.propertyIsEnumerable.call(e,c[a])&&(n[c[a]]=e[c[a]])}return n};function C(e){var t=e.isLeaf,n=e.expanded;return t?r.createElement(m.a,null):n?r.createElement(v,null):r.createElement(E,null)}function L(e){var t=e.treeData,n=e.children;return t||Object(O.c)(n)}var S=function(e,t){var n=e.defaultExpandAll,o=e.defaultExpandParent,l=e.defaultExpandedKeys,i=_(e,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]),f=r.useRef(),m=r.useRef(),p=r.createRef();r.useImperativeHandle(t,(function(){return p.current}));var h=r.useState(i.selectedKeys||i.defaultSelectedKeys||[]),x=Object(d.a)(h,2),v=x[0],y=x[1],N=r.useState(function(){var e=Object(O.a)(L(i)).keyEntities;return n?Object.keys(e):o?Object(j.e)(i.expandedKeys||l,e):i.expandedKeys||l}()),g=Object(d.a)(N,2),E=g[0],w=g[1];r.useEffect((function(){"selectedKeys"in i&&y(i.selectedKeys)}),[i.selectedKeys]),r.useEffect((function(){"expandedKeys"in i&&w(i.expandedKeys)}),[i.expandedKeys]);var S=b()((function(e,t){t.isLeaf||e.shiftKey||e.metaKey||e.ctrlKey||p.current.onNodeExpand(e,t)}),200,{leading:!0}),H=r.useContext(k.b),P=H.getPrefixCls,R=H.direction,D=i.prefixCls,A=i.className,V=_(i,["prefixCls","className"]),T=P("tree",D),q=s()("".concat(T,"-directory"),Object(c.a)({},"".concat(T,"-directory-rtl"),"rtl"===R),A);return r.createElement(F,Object(a.a)({icon:C,ref:p,blockNode:!0},V,{prefixCls:T,className:q,expandedKeys:E,selectedKeys:v,onSelect:function(e,t){var n,c,r=i.multiple,o=t.node,l=t.nativeEvent,s=o.key,d=void 0===s?"":s,b=L(i),j=Object(a.a)(Object(a.a)({},t),{selected:!0}),O=l.ctrlKey||l.metaKey,p=l.shiftKey;r&&O?(c=e,f.current=d,m.current=c,j.selectedNodes=I(b,c)):r&&p?(c=Array.from(new Set([].concat(Object(u.a)(m.current||[]),Object(u.a)(K({treeData:b,expandedKeys:E,startKey:d,endKey:f.current}))))),j.selectedNodes=I(b,c)):(c=[d],f.current=d,m.current=c,j.selectedNodes=I(b,c)),null===(n=i.onSelect)||void 0===n||n.call(i,c,j),"selectedKeys"in i||y(c)},onClick:function(e,t){var n;"click"===i.expandAction&&S(e,t),null===(n=i.onClick)||void 0===n||n.call(i,e,t)},onDoubleClick:function(e,t){var n;"doubleClick"===i.expandAction&&S(e,t),null===(n=i.onDoubleClick)||void 0===n||n.call(i,e,t)},onExpand:function(e,t){var n;return"expandedKeys"in i||w(e),null===(n=i.onExpand)||void 0===n?void 0:n.call(i,e,t)}}))},H=r.forwardRef(S);H.displayName="DirectoryTree",H.defaultProps={showIcon:!0,expandAction:"click"};var P=H,R=n(27),D=n(350);function A(e){var t,n=e.dropPosition,a=e.dropLevelOffset,r=e.prefixCls,l=e.indent,i=e.direction,s=void 0===i?"ltr":i,u="ltr"===s?"left":"right",d="ltr"===s?"right":"left",f=(t={},Object(c.a)(t,u,-a*l+4),Object(c.a)(t,d,0),t);switch(n){case-1:f.top=-3;break;case 1:f.bottom=-3;break;default:f.bottom=-3,f[u]=l+4}return o.a.createElement("div",{style:f,className:"".concat(r,"-drop-indicator")})}var V=r.forwardRef((function(e,t){var n,o=r.useContext(k.b),i=o.getPrefixCls,u=o.direction,d=o.virtual,f=e.prefixCls,b=e.className,j=e.showIcon,O=e.showLine,m=e.switcherIcon,p=e.blockNode,h=e.children,x=e.checkable,v=e.selectable,y=i("tree",f),N=Object(a.a)(Object(a.a)({},e),{showLine:Boolean(O),dropIndicatorRender:A});return r.createElement(l.b,Object(a.a)({itemHeight:20,ref:t,virtual:d},N,{prefixCls:y,className:s()((n={},Object(c.a)(n,"".concat(y,"-icon-hide"),!j),Object(c.a)(n,"".concat(y,"-block-node"),p),Object(c.a)(n,"".concat(y,"-unselectable"),!v),Object(c.a)(n,"".concat(y,"-rtl"),"rtl"===u),n),b),direction:u,checkable:x?r.createElement("span",{className:"".concat(y,"-checkbox-inner")}):x,selectable:v,switcherIcon:function(e){return Object(D.a)(y,m,O,e)}}),h)}));V.TreeNode=l.a,V.DirectoryTree=P,V.defaultProps={checkable:!1,selectable:!0,showIcon:!1,motion:Object(a.a)(Object(a.a)({},R.a),{motionAppear:!1}),blockNode:!1};var F=V;t.a=F},490:function(e,t,n){"use strict";n.r(t);var c=n(30),a=n(23),r=n(22),o=n(318),l=n(317),i=n(363),s=n(476),u=n(64),d=n(53),f=n(63),b=n(0),j=n(473),O=n.n(j),m=n(4);t.default=function(){var e=Object(r.d)(),t=Object(r.h)().query,n=Object(f.a)(t.id),j=Object(a.a)(n,1)[0],p=Object(f.a)(""),h=Object(a.a)(p,2),x=h[0],v=h[1],y=Object(f.a)(""),N=Object(a.a)(y,2),g=N[0],E=N[1],k=Object(f.a)([]),w=Object(a.a)(k,2),K=w[0],I=w[1],_=Object(f.a)([]),C=Object(a.a)(_,2),L=C[0],S=C[1],H=Object(f.a)({roleName:"",status:"1",functionIds:[]}),P=Object(a.a)(H,2),R=P[0],D=P[1],A=Object(f.a)({roleName:"",functionIds:""}),V=Object(a.a)(A,2),F=V[0],T=V[1],q=Object(r.c)(),z=Object(a.a)(q,1)[0],M=Object(r.f)(),$=Object(a.a)(M,1)[0];function B(e,t){D((function(n){n[e]=t}))}function J(e){var t=[];return e.forEach((function(e){var n={};n.key=e.id,n.title=e.name,n.children=e.sonFunctions&&e.sonFunctions.length?J(e.sonFunctions):[],t.push(n)})),t}function G(){z("".concat(window.$api.setting_functions_list)).then((function(e){var t=[],n={key:"all",title:"\u5168\u90e8\u6743\u9650"};n.children=J(e.functions),t.push(n),I(t)})).catch((function(e){return e}))}function Q(){z("".concat(window.$api.setting_role_list,"/").concat(j)).then((function(e){var t=e.role;v(t.roleCode),E(t.userNum),S(t.functionIds),D((function(e){e.roleName=t.roleName,e.status=t.status,e.functionIds=t.functionIds}))})).catch((function(e){return e}))}function X(e){T((function(t){e.forEach((function(e){t[e]=""}))}))}return Object(b.useEffect)((function(){G()}),[]),Object(b.useEffect)((function(){j&&Q()}),[j]),Object(b.useEffect)((function(){var e=L.filter((function(e){return"all"!==e}));B("functionIds",e)}),[K,L]),Object(m.jsx)("div",{className:O.a.box,children:Object(m.jsxs)(l.a,Object(c.a)(Object(c.a)({className:O.a.form},{labelCol:{span:6},wrapperCol:{span:18}}),{},{children:[Object(m.jsx)(l.a.Item,{className:O.a.item,label:"\u804c\u8d23\u7f16\u53f7\uff1a",children:j?x:"(\u7cfb\u7edf\u81ea\u52a8\u751f\u6210)"}),Object(m.jsxs)(l.a.Item,{className:O.a.item,label:"\u804c\u8d23\u540d\u79f0\uff1a",required:!0,children:[Object(m.jsx)(u.a,{placeholder:"\u8bf7\u8f93\u5165",maxLength:20,value:R.roleName,setValue:function(e){B("roleName",e)},onFocus:function(){X(["roleName"])}}),!!F.roleName&&Object(m.jsx)("span",{className:"color-red",children:F.roleName})]}),Object(m.jsx)(l.a.Item,{className:O.a.item,label:"\u72b6\u6001\uff1a",children:Object(m.jsxs)(i.a.Group,{value:R.status,onChange:function(e){B("status",e.target.value)},children:[Object(m.jsx)(i.a,{value:"1",children:"\u6b63\u5e38"}),Object(m.jsx)(i.a,{value:"0",children:"\u7981\u7528"})]})}),Object(m.jsxs)(l.a.Item,{className:O.a.item,label:"\u6743\u9650\uff1a",required:!0,children:[Object(m.jsx)("div",{className:"".concat(O.a.roleList," scroll-y"),children:!!K.length&&Object(m.jsx)(s.a,{checkable:!0,selectable:!1,defaultExpandedKeys:["all"],checkedKeys:L,treeData:K,onCheck:function(e){X(["functionIds"]),S(e)}})}),!!F.functionIds&&Object(m.jsx)("span",{className:"color-red",children:F.functionIds})]}),j&&Object(m.jsxs)(l.a.Item,{className:O.a.item,label:"\u5df2\u6388\u6743\u5e10\u53f7\uff1a",children:[g," \u4e2a"]}),Object(m.jsxs)(l.a.Item,Object(c.a)(Object(c.a)({},{wrapperCol:{offset:6,span:18}}),{},{className:O.a.item,children:[Object(m.jsx)(d.a,{type:"primary",onClick:function(){if(R.roleName&&R.functionIds.length){var t=j?Object(c.a)(Object(c.a)({},R),{},{id:j}):R,n=j?"\u4fdd\u5b58\u6210\u529f\uff01":"\u63d0\u4ea4\u6210\u529f\uff01",a=j?"\u804c\u8d23\u8bb0\u5f55\u5df2\u4fdd\u5b58":"\u65b0\u5efa\u804c\u8d23\u8bb0\u5f55\u6210\u529f";$("".concat(window.$api.setting_role_list),t).then((function(){o.a.success({title:n,content:a,okText:"\u786e\u5b9a",maskClosable:!0,afterClose:function(){e(window.$route.setting_role_list)}})})).catch((function(e){o.a.error({title:j?"\u4fdd\u5b58\u5931\u8d25\uff01":"\u63d0\u4ea4\u5931\u8d25\uff01",okText:"\u5173\u95ed",content:window.$utility.generateRequestErrorMsg(e)})}))}else T((function(e){R.roleName||(e.roleName="\u8bf7\u8f93\u5165\u804c\u8d23\u540d\u79f0\uff01"),R.functionIds.length||(e.functionIds="\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u9879\u6743\u9650\uff01")}))},children:j?"\u4fdd\u5b58":"\u63d0\u4ea4"}),Object(m.jsx)(d.a,{className:"ml-10",onClick:function(){j?Q():(S([]),D({roleName:"",status:"1",functionIds:[]})),X(["roleName","functionIds"])},children:"\u91cd\u7f6e"})]}))]}))})}}}]);