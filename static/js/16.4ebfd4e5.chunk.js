(this["webpackJsonpbounty-admin-pc"]=this["webpackJsonpbounty-admin-pc"]||[]).push([[16],{323:function(e,t,n){"use strict";var r=n(30),a=n(315),i=n(78),c=n(22),s=n(4);function o(e){var t=e.children,n=e.promise,o=e.pendingDelay,d=e.hasBorder,u=e.hasPendingMask,l=Object(c.g)({promise:n,pendingDelay:o}),j=l.isPending,b=l.isDelayOver,p=l.data,f=l.error,m=l.isEmptyForData,h=l.promised,O=l.recentErrors,x={borderTop:d?"1px solid #f0f0f0":"none"};if(!1===h)return null;if(j){var g=!f&&!1===m&&!1===O;return Object(s.jsxs)("div",{style:Object(r.a)({position:"relative"},x),children:[b&&!g&&Object(s.jsx)("div",{style:{textAlign:"center",paddingTop:16},children:Object(s.jsx)(a.a,{})}),g&&t(p,j),g&&u&&Object(s.jsx)("div",{style:{position:"absolute",left:0,right:0,top:0,bottom:0,zIndex:2,backgroundColor:"#ffffff",opacity:.5}})]})}return Object(s.jsxs)("div",{style:x,children:[f&&Object(s.jsx)(i.a,{image:i.a.PRESENTED_IMAGE_SIMPLE,description:f.message||"\u83b7\u53d6\u670d\u52a1\u5668\u6570\u636e\u51fa\u9519"}),!f&&m&&Object(s.jsx)(i.a,{image:i.a.PRESENTED_IMAGE_SIMPLE,description:"\u6682\u65e0\u6570\u636e"}),!f&&!1===m&&t(p,j)]})}o.defaultProps={promise:null,pendingDelay:200,hasBorder:!0,hasPendingMask:!0},t.a=o},332:function(e,t,n){"use strict";var r=n(339),a=n.n(r),i=n(4);t.a=function(e){var t=e.children,n=e.className;return Object(i.jsx)("div",{className:"".concat(a.a.header," ").concat(n||""),children:t})}},339:function(e,t,n){e.exports={header:"style_header__Q4NWp"}},500:function(e,t,n){"use strict";n.r(t);var r=n(30),a=n(23),i=n(0),c=n(63),s=n(323),o=n(332),d=n(22),u=n(91),l=n(491),j=n(494),b=n(318),p=n(53),f=n(4);var m=function(e){var t=e.title,n=e.data,r=e.doFetchRule,c=Object(d.d)(),s=Object(i.useState)(0),u=Object(a.a)(s,2),l=u[0],j=u[1],m=Object(i.useState)(0),h=Object(a.a)(m,2),O=h[0],x=h[1],g=Object(i.useState)(!1),w=Object(a.a)(g,2),I=w[0],v=w[1],y=Object(i.useState)(!1),E=Object(a.a)(y,2),N=E[0],R=E[1],S=Object(d.e)(),C=Object(a.a)(S,1)[0];return Object(i.useEffect)((function(){var e=0,t=0;n.forEach((function(n){t+=n.point*n.itemNum,1===n.required&&(e+=n.point)})),j(e),x(t)}),[n]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(o.a,{className:"mt-14",children:t}),Object(f.jsxs)("div",{className:"mt-14",children:["\u901a\u8fc7\u5ba1\u6838\u6700\u5c11\u5956\u52b1:",Object(f.jsx)("span",{className:"ml-10",children:l})]}),Object(f.jsxs)("div",{className:"mt-8",children:["\u901a\u8fc7\u5ba1\u6838\u6700\u5927\u5956\u52b1:",Object(f.jsx)("span",{className:"ml-10",children:O})]}),Object(f.jsxs)("div",{className:"text-center",children:[Object(f.jsx)(p.a,{type:"primary",loading:N,onClick:function(){R(!0);var e=[];n.forEach((function(t){e.push({id:t.id,point:t.point})})),C(window.$api.operation_rule_detail,e).then((function(){b.a.success({okText:"\u786e\u5b9a",content:"\u4fdd\u5b58\u6210\u529f",onOk:function(){c(window.$route.operation_rule_list)}})})).catch((function(e){window.$utility.message.error(window.$utility.generateRequestErrorMsg(e))})).then((function(){R(!1)}))},children:"\u4fdd\u5b58"}),Object(f.jsx)(p.a,{className:"ml-10",loading:I,onClick:function(){v(!0),r()},children:"\u91cd\u7f6e"})]})]})},h=window.$utility.formatterIntegerForInputNumber,O=window.$utility.parserIntegerForInputNumber,x=["b1","p2"];var g=function(e){var t=e.data,n=e.rowSpan,r=e.titleForTotal,a=e.doFetchRule,c=e.rules,s=e.updateRules,o=e.isPending;return Object(i.useEffect)((function(){!1===o&&s((function(e){e.data=t}))}),[o]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(l.a,{className:"-mt-px",dataSource:c,pagination:!1,size:"small",bordered:!0,children:[Object(f.jsx)(l.a.Column,{title:"\u4e00\u7ea7\u5b57\u6bb5",dataIndex:"firstItem",render:function(e,t,r){var a=function(){return 1===t.required?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("span",{style:{color:"red",marginRight:4},children:"*"}),e]}):e};return n.rowIndex.includes(r)?{children:Object(f.jsx)(a,{}),props:{rowSpan:n.span[n.rowIndex.indexOf(r)]}}:n.mergeRowIndex.includes(r)?{props:{rowSpan:0}}:Object(f.jsx)(a,{})}}),Object(f.jsx)(l.a.Column,{title:"\u4e8c\u7ea7\u5b57\u6bb5",width:"30%",dataIndex:"secondItem",render:function(e,t){if(x.includes(t.itemCode)){var n=[];return(t.auditRewardItems||[]).forEach((function(e){n.push(e.secondItem)})),n.join("/")}return e}}),Object(f.jsx)(l.a.Column,{title:"\u5956\u52b1\u5206\u503c\u8bbe\u7f6e",dataIndex:"point",width:"26%",render:function(e,t){return Object(f.jsx)(j.a,{value:e,formatter:h,parser:function(t){return O(t,e,!1)},onChange:function(e){!function(e,t){s((function(n){var r,a=Object(u.a)(n.data);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i.id===e){i.point=t;break}}}catch(c){a.e(c)}finally{a.f()}}))}(t.id,e)},keyboard:!1,style:{color:"#1890ff",width:"100%"}})}}),Object(f.jsx)(l.a.Column,{title:"\u6570\u91cf",dataIndex:"itemNum",render:function(e){return Object(f.jsxs)("span",{children:["x",e]})}}),Object(f.jsx)(l.a.Column,{title:"\u5c0f\u8ba1",dataIndex:"point",render:function(e,t){return e*t.itemNum}})]}),Object(f.jsx)(m,{title:r,data:c,doFetchRule:a})]})};t.default=function(){var e=Object(i.useState)({}),t=Object(a.a)(e,2),n=t[0],u=t[1],l=Object(d.c)(),j=Object(a.a)(l,1)[0],b=Object(i.useState)(null),p=Object(a.a)(b,2),m=p[0],h=p[1],O=Object(d.h)().query,x=Object(c.a)({data:null}),w=Object(a.a)(x,2),I=w[0],v=w[1];function y(){h(j(window.$api.operation_rule_detail,{ruleCode:O.ruleCode}).then((function(e){var t=["p10"],n={rowIndex:[],mergeRowIndex:[],span:[]},a=[];return e.dataList.forEach((function(e,i){t.includes(e.itemCode)?e.auditRewardItems&&e.auditRewardItems.length>0&&(e.auditRewardItems.forEach((function(t,c){a.push(Object(r.a)(Object(r.a)({},t),{},{key:t.id,firstItem:e.firstItem})),0!==c&&n.mergeRowIndex.push(i+c)})),n.rowIndex.push(i),n.span.push(e.auditRewardItems.length)):a.push(Object(r.a)(Object(r.a)({},e),{},{key:e.id}))})),u(n),a})).catch((function(){throw new Error})))}return Object(d.b)((function(){y()})),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(o.a,{className:"mb-10",children:"SH00000002"===O.ruleCode?"\u54c1\u724c\u5956\u52b1\u8bbe\u7f6e":"\u5546\u54c1\u5956\u52b1\u8bbe\u7f6e"}),Object(f.jsx)(s.a,{promise:m,hasBorder:!1,hasPendingMask:!1,children:function(e,t){return Object(f.jsx)(g,{rules:I.data||e,isPending:t,data:e,rowSpan:n,doFetchRule:y,updateRules:v,titleForTotal:"SH00000002"===O.ruleCode?"\u54c1\u724c\u5956\u52b1\u7edf\u8ba1":"\u5546\u54c1\u5956\u52b1\u7edf\u8ba1"})}})]})}}}]);