(this["webpackJsonpbounty-admin-pc"]=this["webpackJsonpbounty-admin-pc"]||[]).push([[18],{323:function(e,t,a){"use strict";var n=a(30),s=a(315),r=a(78),c=a(22),i=a(4);function o(e){var t=e.children,a=e.promise,o=e.pendingDelay,l=e.hasBorder,d=e.hasPendingMask,u=Object(c.g)({promise:a,pendingDelay:o}),j=u.isPending,b=u.isDelayOver,f=u.data,m=u.error,O=u.isEmptyForData,h=u.promised,p=u.recentErrors,x={borderTop:l?"1px solid #f0f0f0":"none"};if(!1===h)return null;if(j){var v=!m&&!1===O&&!1===p;return Object(i.jsxs)("div",{style:Object(n.a)({position:"relative"},x),children:[b&&!v&&Object(i.jsx)("div",{style:{textAlign:"center",paddingTop:16},children:Object(i.jsx)(s.a,{})}),v&&t(f,j),v&&d&&Object(i.jsx)("div",{style:{position:"absolute",left:0,right:0,top:0,bottom:0,zIndex:2,backgroundColor:"#ffffff",opacity:.5}})]})}return Object(i.jsxs)("div",{style:x,children:[m&&Object(i.jsx)(r.a,{image:r.a.PRESENTED_IMAGE_SIMPLE,description:m.message||"\u83b7\u53d6\u670d\u52a1\u5668\u6570\u636e\u51fa\u9519"}),!m&&O&&Object(i.jsx)(r.a,{image:r.a.PRESENTED_IMAGE_SIMPLE,description:"\u6682\u65e0\u6570\u636e"}),!m&&!1===O&&t(f,j)]})}o.defaultProps={promise:null,pendingDelay:200,hasBorder:!0,hasPendingMask:!0},t.a=o},332:function(e,t,a){"use strict";var n=a(339),s=a.n(n),r=a(4);t.a=function(e){var t=e.children,a=e.className;return Object(r.jsx)("div",{className:"".concat(s.a.header," ").concat(a||""),children:t})}},339:function(e,t,a){e.exports={header:"style_header__Q4NWp"}},498:function(e,t,a){"use strict";a.r(t);var n=a(30),s=a(23),r=a(0),c=a(63),i=a(323),o=a(22),l=a(91),d=a(317),u=a(312),j=a(363),b=a(332),f=a(64),m=a(4);var O=function(e){var t=e.data,a=e.updateTitle,n=e.updateSubTitle,s=e.updateStatus,r=e.error,c=e.updateError;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(b.a,{className:"mb-10",children:"\u57fa\u672c\u4fe1\u606f"}),Object(m.jsxs)(d.a,{component:!1,labelCol:{span:6},children:[Object(m.jsx)(d.a.Item,{className:"form-item-mb-10",label:"\u4efb\u52a1\u7f16\u53f7",children:t.jobCode}),Object(m.jsxs)(d.a.Item,{className:"form-item-mb-16",label:"\u4efb\u52a1\u540d\u79f0",required:!0,children:[Object(m.jsx)(f.a,{value:t.title,setValue:function(e){a(e),c((function(e){e.title.status=!1}))},maxLength:20,placeholder:"\u8bf7\u8f93\u5165..."}),r.title.status&&Object(m.jsx)("div",{className:"color-red mt-5",children:"\u8bf7\u8f93\u516520\u5b57\u4ee5\u5185\u4efb\u52a1\u540d\u79f0"})]}),Object(m.jsxs)(d.a.Item,{className:"form-item-mb-10",label:"\u4efb\u52a1\u526f\u6807\u9898",required:!0,children:[Object(m.jsx)(u.a.TextArea,{value:t.subTitle,maxLength:50,autoSize:{minRows:2,maxRows:3},placeholder:"\u8bf7\u8f93\u5165...",onChange:function(e){n(e.target.value),c((function(e){e.subTitle.status=!1}))},onBlur:function(e){n(e.target.value.trim())}}),r.subTitle.status&&Object(m.jsx)("div",{className:"color-red mt-5",children:"\u8bf7\u8f93\u516550\u5b57\u4ee5\u5185\u4efb\u52a1\u526f\u6807\u9898"})]}),Object(m.jsx)(d.a.Item,{className:"form-item-mb-16",label:"\u72b6\u6001",children:Object(m.jsxs)(j.a.Group,{value:t.status,onChange:function(e){s(e.target.value)},children:[Object(m.jsx)(j.a,{value:0,children:"\u6b63\u5e38"}),Object(m.jsx)(j.a,{value:1,children:"\u7981\u7528"})]})})]})]})};var h=function(e){var t=e.text;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(b.a,{className:"mb-10",children:"\u4efb\u52a1\u89c4\u5219"}),Object(m.jsx)(d.a,{component:!1,labelCol:{span:6},children:Object(m.jsx)(d.a.Item,{className:"form-item-mb-0",label:"\u89e6\u53d1\u6761\u4ef6",children:t})})]})},p=a(318),x=a(491),v=a(494),g=a(53),y=window.$utility.formatterIntegerForInputNumber,w=window.$utility.parserIntegerForInputNumber;var k=function(e){var t=Object(o.d)(),a=e.data,n=e.updateNum,c=e.doFetchTaskInfo,i=e.deleteLastLevel,d=e.addLevel,u=e.error,j=e.updateError,f=Object(r.useState)(!1),O=Object(s.a)(f,2),h=O[0],k=O[1],N=Object(r.useState)(!1),T=Object(s.a)(N,2),C=T[0],L=T[1],I=Object(o.e)(),R=Object(s.a)(I,1)[0];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(b.a,{className:"mb-10",children:"\u5956\u52b1\u4fe1\u606f"}),Object(m.jsx)("div",{className:"leading-32 mb-10",children:"\u4efb\u52a1\u7b49\u7ea7:"}),Object(m.jsxs)(x.a,{dataSource:a.jobRewardLevelVOs,pagination:!1,size:"small",bordered:!0,children:[Object(m.jsx)(x.a.Column,{title:"\u7b49\u7ea7",dataIndex:"type",render:function(e){return"Lv".concat(e)}}),Object(m.jsx)(x.a.Column,{title:"",width:30,align:"center",render:function(){return"\u2265"}}),Object(m.jsx)(x.a.Column,{title:"\u5df2\u6536\u5f55\u6570\u91cf",dataIndex:"count",width:"22%",render:function(e,t){return Object(m.jsx)(v.a,{value:e,formatter:y,parser:function(t){return w(t,e,!1)},onChange:function(e){j((function(e){e.level.status=!1})),n(e,t.type,"count")},keyboard:!1,style:{color:"#1890ff",width:"100%"}})}}),Object(m.jsx)(x.a.Column,{title:"\u5956\u52b1\u91d1\u5e01",dataIndex:"amount",width:"22%",render:function(e,t){return Object(m.jsx)(v.a,{value:e,formatter:y,parser:function(t){return w(t,e,!1)},onChange:function(e){j((function(e){e.level.status=!1})),n(e,t.type,"amount")},keyboard:!1,style:{color:"#1890ff",width:"100%"}})}}),Object(m.jsx)(x.a.Column,{title:"\u7d2f\u8ba1\u5956\u52b1\u7684\u6b21\u6570",dataIndex:"totalCount",align:"right"}),Object(m.jsx)(x.a.Column,{title:"\u7d2f\u8ba1\u53d1\u653e\u91d1\u5e01",dataIndex:"totalAmount",align:"right"})]}),Object(m.jsxs)("div",{className:"mt-10 text-right clearfix",style:{lineHeight:"24px"},children:[u.level.status&&Object(m.jsx)("span",{className:"color-red float-left",children:"\u8bf7\u8f93\u5165\u7d2f\u8ba1\u6570\u91cf\u548c\u5956\u52b1\u91d1\u989d"}),a.jobRewardLevelVOs.length<10&&Object(m.jsx)(g.a,{size:"small",onClick:d,children:"\u6dfb\u52a0\u65b0\u884c"}),a.jobRewardLevelVOs.length>1&&Object(m.jsx)(g.a,{className:"ml-8",size:"small",onClick:i,children:"\u5220\u9664\u6700\u540e\u4e00\u884c"})]}),Object(m.jsx)("div",{className:"color-gray font-size-12 leading-32 mt-8",children:"\u63d0\u793a\uff1a\u7528\u6237\u5b8c\u6210\u6700\u9ad8\u7b49\u7ea7\u7684\u4efb\u52a1\u540e\uff0c\u4efb\u52a1\u81ea\u52a8\u6d88\u5931\u3002"}),Object(m.jsxs)("div",{className:"mt-10",children:[Object(m.jsx)(g.a,{type:"primary",loading:C,onClick:function(){if(!1!==function(){var e=!0,t=!1,n=!1,s=!1;""===a.title&&(t=!0),""===a.subTitle&&(n=!0);var r,c=Object(l.a)(a.jobRewardLevelVOs);try{for(c.s();!(r=c.n()).done;){var i=r.value;if(""===i.count||""===i.amount){s=!0;break}}}catch(o){c.e(o)}finally{c.f()}return j((function(e){e.title.status=t,e.subTitle.status=n,e.level.status=s})),(t||n||s)&&(e=!1),e}()){L(!0);var e={jobCode:a.jobCode,title:a.title,subTitle:a.subTitle,status:a.status,gradeDatas:[]};a.jobRewardLevelVOs.forEach((function(t){e.gradeDatas.push({type:t.type,count:t.count,amount:t.amount})})),R(window.$api.operation_task_detail,e).then((function(){p.a.success({okText:"\u786e\u5b9a",content:"\u4fdd\u5b58\u6210\u529f",onOk:function(){t(window.$route.operation_task_list)}})})).catch((function(){})).then((function(){L(!1)}))}},children:"\u4fdd\u5b58"}),Object(m.jsx)(g.a,{className:"ml-10",loading:h,onClick:function(){k(!0),c()},children:"\u91cd\u7f6e"})]})]})};var N=function(e){var t=Object(c.a)({title:{status:!1},subTitle:{status:!1},level:{status:!1}}),a=Object(s.a)(t,2),n=a[0],i=a[1],o=e.data,d=e.triggerConditionsText,u=e.doFetchTaskInfo,j=e.updateTaskData,b=e.isPending,f=e.taskData;return Object(r.useEffect)((function(){!1===b&&j((function(e){e.data=o}))}),[b]),f&&Object(m.jsxs)("div",{className:"relative",style:{minHeight:340},children:[Object(m.jsxs)("div",{className:"absolute",style:{width:400,left:0,top:0},children:[Object(m.jsx)(O,{data:f,error:n,updateError:i,updateTitle:function(e){j((function(t){t.data.title=e}))},updateSubTitle:function(e){j((function(t){t.data.subTitle=e}))},updateStatus:function(e){j((function(t){t.data.status=e}))}}),Object(m.jsx)(h,{text:d})]}),Object(m.jsx)("div",{style:{marginLeft:440},children:Object(m.jsx)(k,{data:f,error:n,updateError:i,updateNum:function(e,t,a){j((function(n){var s,r=Object(l.a)(n.data.jobRewardLevelVOs);try{for(r.s();!(s=r.n()).done;){var c=s.value;if(c.type===t){c[a]=e;break}}}catch(i){r.e(i)}finally{r.f()}}))},deleteLastLevel:function(){j((function(e){e.data.jobRewardLevelVOs.splice(e.data.jobRewardLevelVOs.length-1,1)}))},addLevel:function(){j((function(e){e.data.jobRewardLevelVOs.push({key:e.data.jobRewardLevelVOs.length+1,amount:"",count:"",totalAmount:0,totalCount:0,type:e.data.jobRewardLevelVOs.length+1})}))},doFetchTaskInfo:u})}),Object(m.jsx)("div",{className:"absolute",style:{left:420,top:-16,width:1,height:"100%",backgroundColor:"#d9d9d9",boxSizing:"content-box",padding:"16px 0"}})]})};t.default=function(){var e=Object(o.c)(),t=Object(s.a)(e,1)[0],a=Object(r.useState)(null),l=Object(s.a)(a,2),d=l[0],u=l[1],j=Object(c.a)({data:null}),b=Object(s.a)(j,2),f=b[0],O=b[1],h=Object(o.h)().query;function p(){u(t("".concat(window.$api.operation_task_detail,"/").concat(h.code)).then((function(e){return Object(n.a)(Object(n.a)({},e.jobRewardDetailVO),{},{jobRewardLevelVOs:e.jobRewardDetailVO.jobRewardLevelVOs.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{key:e.type})}))})})).catch((function(){throw new Error})))}return Object(o.b)((function(){p()})),Object(m.jsx)(i.a,{promise:d,hasBorder:!1,hasPendingMask:!1,children:function(e,t){return Object(m.jsx)(N,{taskData:f.data||e,data:e,isPending:t,updateTaskData:O,doFetchTaskInfo:p,triggerConditionsText:"RW00000001"===h.code?"\u5546\u54c1\u901a\u8fc7\u5ba1\u6838":"\u54c1\u724c\u901a\u8fc7\u5ba1\u6838"})}})}}}]);