(this["webpackJsonpbounty-admin-pc"]=this["webpackJsonpbounty-admin-pc"]||[]).push([[27],{381:function(t,e,a){t.exports={user:"style_user__2Om38",avatar:"style_avatar__1ZPMq",info:"style_info__27nCg",name:"style_name__3f-uf",role:"style_role__1TxKh",welcome:"style_welcome__1POw6","statistics-list":"style_statistics-list__18zrg",item:"style_item__pHksC","yesterday-num":"style_yesterday-num__3a5Vn","total-box":"style_total-box__vaZMf","total-num":"style_total-num__27qAU","statistics-tab":"style_statistics-tab__1WXRc","load-error":"style_load-error__3pqgW"}},497:function(t,e,a){"use strict";a.r(e);var n=a(23),i=a(0),c=a(63),s=a(42),r=a(319),o=a(381),d=a.n(o),l=a(4),u=function(){return Object(l.jsx)("span",{className:"icon-user-fill"})},j=function(){var t=Object(s.b)().globalState;return Object(l.jsxs)("div",{className:"".concat(d.a.user," clearfix"),children:[Object(l.jsx)(r.a,{className:d.a.avatar,style:{backgroundColor:"#87d068"},size:60,icon:Object(l.jsx)(u,{})}),Object(l.jsxs)("div",{className:d.a.info,children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("span",{className:d.a.name,children:t.user.name}),!!t.user.roleNames.length&&Object(l.jsxs)("span",{className:d.a.role,children:["\uff08",t.user.roleNames.join("\u3001"),"\uff09"]})]}),Object(l.jsx)("div",{className:d.a.welcome,children:"\u65e9\u5b89\uff0c\u795d\u60a8\u5f00\u5fc3\u6bcf\u4e00\u5929\uff01"})]})]})},b=a(22),m=a(427),O=function(t){var e=Object.assign({},t),a="list-".concat(e.data.name),n=e.data.data.dayNums;return Object(i.useEffect)((function(){setTimeout((function(){var t=n.length,i=n.map((function(e,a){return{idx:JSON.stringify(t-a),num:Number(e)}})),c=new m.a({container:a,autoFit:!0,height:40});c.data(i),c.scale("num",{nice:!0}),c.axis(!1),c.tooltip(!1),c.interval().position("idx*num").color(e.data.color),c.render()}))}),[]),Object(l.jsx)("div",{id:a})},f=function(t){var e=Object(b.c)(),a=Object(n.a)(e,1)[0],s=Object.assign({},t),r=Object(c.a)(null),o=Object(n.a)(r,2),u=o[0],j=o[1],m=Object(c.a)([]),f=Object(n.a)(m,2),h=f[0],p=f[1];return Object(i.useEffect)((function(){u&&clearTimeout(u);var t=setTimeout((function(){p([]),a(window.$api.statistics).then((function(t){var e=[];e.push({name:"login",color:"#ac83c8",totalTitle:"\u7d2f\u8ba1\u7528\u6237",yesterdayTitle:"\u6628\u65e5\u6d3b\u8dc3\u7528\u6237",data:t.login}),e.push({name:"task",color:"#80abf7",totalTitle:"\u7d2f\u8ba1\u5b8c\u6210\u4efb\u52a1",yesterdayTitle:"\u6628\u65e5\u5b8c\u6210\u4efb\u52a1",data:t.task}),e.push({name:"product",color:"#81e0bc",totalTitle:"\u7d2f\u8ba1\u6536\u5f55\u5546\u54c1",yesterdayTitle:"\u6628\u65e5\u5df2\u901a\u8fc7\u5ba1\u6838\u5546\u54c1",data:t.product}),e.push({name:"brand",color:"#fdb071",totalTitle:"\u7d2f\u8ba1\u6536\u5f55\u54c1\u724c",yesterdayTitle:"\u6628\u65e5\u5df2\u901a\u8fc7\u5ba1\u6838\u54c1\u724c",data:t.brand}),p(e)})).catch((function(){p([])}))}),100);j(t)}),[s.windowWidth]),Object(l.jsx)("div",{className:d.a["statistics-list"],children:h.length?h.map((function(t,e){return Object(l.jsxs)("div",{className:"".concat(d.a.item),children:[Object(l.jsx)("div",{children:t.yesterdayTitle}),Object(l.jsx)("div",{className:d.a["yesterday-num"],children:window.$utility.thousandBitSeparator(t.data.yesterdayNum)}),Object(l.jsx)(O,{data:t}),Object(l.jsxs)("div",{className:d.a["total-box"],children:[Object(l.jsx)("span",{children:t.totalTitle}),Object(l.jsx)("span",{className:d.a["total-num"],children:window.$utility.thousandBitSeparator(t.data.totalNum)})]})]},e)})):Object(l.jsx)("div",{className:d.a["load-error"],children:"\u7edf\u8ba1\u6570\u636e\u52a0\u8f7d\u5931\u8d25\uff01"})})},h=a(492),p=a(428),x=a(363),y=a(315),v=a(129),g=a.n(v),w=function(t){var e=Object.assign({},t),a="tab-".concat(e.statisticsType),c=e.data,s=Object(i.useState)(!1),r=Object(n.a)(s,2),o=r[0],d=r[1];return Object(i.useEffect)((function(){setTimeout((function(){var t=c.map((function(t){return{statisticDate:t.statisticDate+("mm"===e.formatType?" \u6708":""),statisticNum:Number(t.statisticNum)}})),n=new m.a({container:a,autoFit:!0,height:300});n.data(t),n.scale("statisticNum",{nice:!0}),n.tooltip({showCrosshairs:!0,showTitle:!1,itemTpl:'<div style="text-align: left;"><p>\u65e5\u671f\uff1a{statisticDate}</p><p>\u6570\u636e\uff1a{statisticNum} \u6761</p></div>'}),n.interaction("active-region"),n.line().position("statisticDate*statisticNum").tooltip("statisticDate*statisticNum",(function(t,e){return{statisticDate:t,statisticNum:e}})),n.point().position("statisticDate*statisticNum"),n.render(),d(!0)}))}),[]),Object(l.jsxs)("div",{style:{width:"100%"},children:[Object(l.jsx)("span",{style:{fontSize:0,lineHeight:1,display:o?"none":"inline-block"},children:"1"}),Object(l.jsx)("div",{id:a})]})},_=h.a.TabPane,T=p.a.RangePicker,N=function(t){var e=Object(b.c)(),a=Object(n.a)(e,1)[0],s=Object.assign({},t),r=Object(c.a)(null),o=Object(n.a)(r,2),u=o[0],j=o[1],m=Object(c.a)("PRODUCT"),O=Object(n.a)(m,2),f=O[0],p=O[1],v=Object(c.a)("mm.dd"),N=Object(n.a)(v,2),C=N[0],D=N[1],M=Object(c.a)({dateMoment:[],dateString:[]}),Y=Object(n.a)(M,2),S=Y[0],E=Y[1],k=Object(c.a)({}),B=Object(n.a)(k,2),P=B[0],W=B[1],R=Object(c.a)({product:[],brand:[]}),z=Object(n.a)(R,2),H=z[0],A=z[1],F=Object(c.a)(!0),J=Object(n.a)(F,2),U=J[0],$=J[1],q=Object(c.a)([]),K=Object(n.a)(q,2),L=K[0],Z=K[1],G=Object(c.a)(),V=Object(n.a)(G,2),X=V[0],I=V[1],Q=function(t){var e,a=!1,n=!1;return"mm"===C?(e=t&&t>g()().endOf("month"),L&&2===L.length&&(a=L[0]&&t.diff(L[0],"month")>10,n=L[1]&&L[1].diff(t,"month")>10)):(e=t&&t>g()().endOf("day"),L&&2===L.length&&(a=L[0]&&t.diff(L[0],"day")>30,n=L[1]&&L[1].diff(t,"day")>30)),e||n||a},tt=function(t){t?(I([]),Z([])):I(void 0)};function et(t){E(t)}function at(){$(!0),A((function(t){t.product=[],t.brand=[]}));var t="".concat(window.$api.statistics,"/").concat(f);a(t,P).then((function(t){A("PRODUCT"===f?function(e){e.product=t.statistics}:function(e){e.brand=t.statistics}),$(!1)})).catch((function(){A({})}))}Object(i.useEffect)((function(){W((function(t){t.formatType=C,t.startTime=S.dateString[0],t.endTime=S.dateString[1]}))}),[C,S]),Object(i.useEffect)((function(){if("mm"===C){var t=g()().subtract(11,"month"),e=g()().endOf("day");E({dateMoment:[t,e],dateString:[g()(t).format("YYYY-MM"),g()(e).format("YYYY-MM")]})}else{var a=g()().subtract(30,"day"),n=g()().endOf("day");E({dateMoment:[a,n],dateString:[g()(a).format("YYYY-MM-DD"),g()(n).format("YYYY-MM-DD")]})}}),[C]),Object(i.useEffect)((function(){u&&clearTimeout(u);var t=setTimeout((function(){P.startTime&&P.endTime&&at()}),100);j(t)}),[s.windowWidth]),Object(i.useEffect)((function(){P.startTime&&P.endTime&&at()}),[f,P.startTime,P.endTime]);var nt=Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("span",{children:"\u7c7b\u578b\uff1a"}),Object(l.jsxs)(x.a.Group,{value:C,onChange:function(t){D(t.target.value)},style:{marginBottom:5},children:[Object(l.jsx)(x.a.Button,{value:"mm",children:"\u6708"}),Object(l.jsx)(x.a.Button,{value:"mm.dd",children:"\u65e5"})]}),Object(l.jsx)("span",{className:"ml-10",children:"\u6708\u4efd\u8303\u56f4\uff1a"}),"mm"===C?Object(l.jsx)(T,{picker:"month",value:X||S.dateMoment,disabledDate:Q,onCalendarChange:function(t){return Z(t)},onChange:function(t,e){et({dateMoment:t,dateString:e})},onOpenChange:tt}):Object(l.jsx)(T,{value:X||S.dateMoment,disabledDate:Q,onCalendarChange:function(t){return Z(t)},onChange:function(t,e){et({dateMoment:t,dateString:e})},onOpenChange:tt})]});return Object(l.jsx)("div",{className:d.a["statistics-tab"],children:"{}"!==JSON.stringify(H)?Object(l.jsxs)(h.a,{tabBarExtraContent:nt,activeKey:f,onChange:function(t){p(t)},children:[Object(l.jsx)(_,{tab:"\u65b0\u6536\u5f55\u5546\u54c1",children:Object(l.jsx)("div",{style:{lineHeight:"300px",textAlign:"center"},children:U?Object(l.jsx)(y.a,{}):Object(l.jsx)("div",{children:H.product.length?Object(l.jsx)(w,{data:H.product,statisticsType:"product",formatType:C}):Object(l.jsx)("span",{children:"\u6570\u636e\u4e3a\u7a7a\uff01"})})})},"PRODUCT"),Object(l.jsx)(_,{tab:"\u65b0\u6536\u5f55\u54c1\u724c",children:Object(l.jsx)("div",{style:{lineHeight:"300px",textAlign:"center"},children:U?Object(l.jsx)(y.a,{}):Object(l.jsx)("div",{children:H.brand.length?Object(l.jsx)(w,{data:H.brand,statisticsType:"brand",formatType:C}):Object(l.jsx)("span",{children:"\u6570\u636e\u4e3a\u7a7a\uff01"})})})},"BRAND")]}):Object(l.jsx)("div",{className:d.a["load-error"],children:"\u65b0\u6536\u5f55\u6570\u636e\u52a0\u8f7d\u5931\u8d25\uff01"})})};e.default=function(){var t="object"===typeof window,e=Object(i.useCallback)((function(){return{width:t?window.innerWidth:void 0,height:t?window.innerHeight:void 0}}),[t]),a=Object(c.a)(e),s=Object(n.a)(a,2),r=s[0],o=s[1];return Object(i.useEffect)((function(){if(!t)return!1;function a(){o(e())}return window.addEventListener("resize",a),function(){return window.removeEventListener("resize",a)}}),[e,t]),Object(i.useEffect)((function(){}),[r.width]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(j,{}),Object(l.jsx)(f,{windowWidth:r.width}),Object(l.jsx)(N,{windowWidth:r.width})]})}}}]);